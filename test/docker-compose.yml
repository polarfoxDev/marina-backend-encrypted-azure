services:
  marina:
    image: polarfoxdev/marina:0.7.1
    container_name: marina
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - /tmp/marina:/backup
      - marina:/var/lib/marina
      - ./.config.secret.yml:/config.yml:ro
    ports:
      - "8080:8080"

  db:
    image: mariadb:11
    container_name: db
    environment:
      - MARIADB_ROOT_PASSWORD=maripass

  app:
    image: alpine:3.20
    container_name: app
    command: ["sh", "-lc", "echo 'volume test data' > /mnt/data/test.txt && dd if=/dev/urandom of=/mnt/data/random.bin bs=1M count=10 && sleep infinity"]
    volumes:
      - data:/mnt/data

volumes:
  data:
  marina:
